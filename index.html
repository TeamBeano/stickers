<html>
<head>
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
	<script src="http://code.jquery.com/jquery-1.11.3.js"></script>
	<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script src="jquery.ui.touch-punch.js"></script>
	<script src="jquery.ui.rotatable.js"></script>
	<link rel="stylesheet" href="jquery.ui.rotatable.css">
  <script src="http://cburgmer.github.io/rasterizeHTML.js/rasterizeHTML.allinone.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {
      $('#target3').resizable({aspectRatio: $('#target3').width()/$('#target3').height()}).rotatable(); $('#draggable3').draggable();

      $('.save').on('click', function() {
        console.log('save')
        var canvas = document.getElementById("canvas"),
            context = canvas.getContext('2d'),
            html_container = document.getElementById("container"),
            html = html_container.innerHTML;

        rasterizeHTML.drawHTML(html).then(function (renderResult) {
            console.log('rendered')
            context.drawImage(renderResult.image, 10, 25);
        });
      })
		});
	</script>
  <style media="screen">
    .picture{
      width: 600px;
      height: 600px;
      position: relative;
    }
    img{max-width: 100%}
    .background{
      position: absolute;
    }
    #container{
      height: 800px;
    }
  </style>
</head>
<body>
  <div id='container'>
    <div class="picture">
      <img src="pic.jpg" class='background' />
      <div id="draggable3">
        html
        <div id="target3" style="width: 266px; height:392px;">
          <img src="23.png" alt="" />
        </div>
      </div>
    </div>
  </div>
  <a class='save'>Save</a>
  <canvas id="canvas" width="300" height="200" style="border: 1px solid black;"></canvas>
</body>
</html>
